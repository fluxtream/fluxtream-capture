/*! Copyright 2011 Trigger Corp. All rights reserved. */
(function(){var m={};var n={};m.config={modules:{}};m.config.uuid="UUID_HERE";n.listeners={};var p={};var i=[];var h=null;var a=false;var r=function(){if(i.length>0){if(!n.debug||window.catalystConnected){a=true;while(i.length>0){var s=i.shift();if(s[0]=="logging.log"){console.log(s[1].message)}n.priv.call.apply(n.priv,s)}a=false}else{h=setTimeout(r,500)}}};n.priv={call:function(z,y,x,t){if((!n.debug||window.catalystConnected||z==="internal.showDebugWarning")&&(i.length==0||a)){var s=m.tools.UUID();var v=true;if(z==="button.onClicked.addListener"||z==="message.toFocussed"){v=false}if(x||t){p[s]={success:x,error:t,onetime:v}}var u={callid:s,method:z,params:y};n.priv.send(u);if(window._forgeDebug){try{u.start=(new Date().getTime())/1000;window._forgeDebug.forge.APICall.apiRequest(u)}catch(w){}}}else{i.push(arguments);if(!h){h=setTimeout(r,500)}}},send:function(s){throw new Error("Forge error: missing bridge to privileged code")},receive:function(s){if(s.callid){if(typeof p[s.callid]===undefined){m.log("Nothing stored for call ID: "+s.callid)}var u=p[s.callid];var t=(typeof s.content==="undefined"?null:s.content);if(u&&u[s.status]){u[s.status](s.content)}if(u&&u.onetime){delete p[s.callid]}if(window._forgeDebug){try{s.end=(new Date().getTime())/1000;window._forgeDebug.forge.APICall.apiResponse(s)}catch(v){}}}else{if(s.event){if(n.listeners[s.event]){n.listeners[s.event].forEach(function(w){if(s.params){w(s.params)}else{w()}})}if(n.listeners["*"]){n.listeners["*"].forEach(function(w){if(s.params){w(s.event,s.params)}else{w(s.event)}})}if(window._forgeDebug){try{s.start=(new Date().getTime())/1000;window._forgeDebug.forge.APICall.apiEvent(s)}catch(v){}}}}}};n.addEventListener=function(s,t){if(n.listeners[s]){n.listeners[s].push(t)}else{n.listeners[s]=[t]}};n.generateQueryString=function(t){if(!t){return""}if(!(t instanceof Object)){return new String(t).toString()}var u=[];var s=function(A,z){if(A===null){return}else{if(A instanceof Array){var w=0;for(var v in A){var y=(z?z:"")+"["+w+"]";w+=1;if(!A.hasOwnProperty(v)){continue}s(A[v],y)}}else{if(A instanceof Object){for(var v in A){if(!A.hasOwnProperty(v)){continue}var y=v;if(z){y=z+"["+v+"]"}s(A[v],y)}}else{u.push(encodeURIComponent(z)+"="+encodeURIComponent(A))}}}};s(t);return u.join("&").replace("%20","+")};n.generateMultipartString=function(t,v){if(typeof t==="string"){return""}var u="";for(var s in t){if(!t.hasOwnProperty(s)){continue}if(t[s]===null){continue}u+="--"+v+"\r\n";u+='Content-Disposition: form-data; name="'+s.replace('"','\\"')+'"\r\n\r\n';u+=t[s].toString()+"\r\n"}return u};n.generateURI=function(t,s){var u="";if(t.indexOf("?")!==-1){u+=t.split("?")[1]+"&";t=t.split("?")[0]}u+=this.generateQueryString(s)+"&";u=u.substring(0,u.length-1);return t+(u?"?"+u:"")};n.disabledModule=function(s,t){var u="The '"+t+"' module is disabled for this app, enable it in your app config and rebuild in order to use this function";m.logging.error(u);s&&s({message:u,type:"UNAVAILABLE",subtype:"DISABLED_MODULE"})};m.enableDebug=function(){n.debug=true;n.priv.call("internal.showDebugWarning",{},null,null);n.priv.call("internal.hideDebugWarning",{},null,null)};setTimeout(function(){if(window.forge&&window.forge.debug){alert("Warning!\n\n'forge.debug = true;' is no longer supported\n\nUse 'forge.enableDebug();' instead.")}},3000);m.barcode={scan:function(t,s){n.disabledModule(s,"barcode")}};m.button={setIcon:function(t,u,s){n.disabledModule(s,"button")},setURL:function(t,u,s){n.disabledModule(s,"button")},onClicked:{addListener:function(s){n.disabledModule(error,"button")}},setBadge:function(t,u,s){n.disabledModule(s,"button")},setBadgeBackgroundColor:function(t,u,s){n.disabledModule(s,"button")},setTitle:function(u,t,s){n.disabledModule(s,"button")}};m.contact={select:function(t,s){n.disabledModule(s,"contact")},selectById:function(u,t,s){n.disabledModule(s,"contact")},selectAll:function(t,s){n.disabledModule(s,"contact")}};m.display={orientation:{forcePortrait:function(t,s){n.disabledModule(s,"display")},forceLandscape:function(t,s){n.disabledModule(s,"display")},allowAny:function(t,s){n.disabledModule(s,"display")}}};m.document={reload:function(){return document.location.reload()},location:function(t,s){t(document.location)}};m.event={menuPressed:{addListener:function(t,s){n.disabledModule(s,"event")}},backPressed:{addListener:function(t,s){n.disabledModule(s,"event")},preventDefault:function(t,s){n.disabledModule(s,"event")}},messagePushed:{addListener:function(t,s){n.disabledModule(s,"event")}},orientationChange:{addListener:function(t,s){n.disabledModule(s,"event")}},connectionStateChange:{addListener:function(t,s){n.disabledModule(s,"event")}},appPaused:{addListener:function(t,s){n.disabledModule(s,"event")}},appResumed:{addListener:function(t,s){n.disabledModule(s,"event")}}};m.facebook={authorize:function(u,t,v,s){if(typeof u=="function"){s=t;v=u;u=[];t=undefined}else{if(typeof t==="function"){s=v;v=t;t=undefined}}n.disabledModule(s,"facebook")},hasAuthorized:function(t,u,s){if(typeof t=="function"){s=audience;u=t;t=[];audience=undefined}else{if(typeof audience==="function"){s=u;u=audience;audience=undefined}}n.disabledModule(s,"facebook")},logout:function(t,s){n.disabledModule(s,"facebook")},api:function(t,w,v,u,s){if(typeof w=="function"||arguments.length==1){s=v}else{if(typeof v=="function"||arguments.length==2){s=u}}n.disabledModule(s,"facebook")},ui:function(u,t,s){n.disabledModule(s,"facebook")}};m.file={getImage:function(t,u,s){n.disabledModule(s,"file")},getVideo:function(t,u,s){n.disabledModule(s,"file")},getLocal:function(t,u,s){n.disabledModule(s,"file")},base64:function(t,u,s){n.disabledModule(s,"file")},string:function(t,u,s){n.disabledModule(s,"file")},URL:function(t,u,v,s){n.disabledModule(s,"file")},isFile:function(t,u,s){n.disabledModule(s,"file")},cacheURL:function(t,u,s){n.disabledModule(s,"file")},remove:function(t,u,s){n.disabledModule(s,"file")},clearCache:function(t,s){n.disabledModule(s,"file")}};m.geolocation={getCurrentPosition:function(v,u,w){if(typeof(v)==="object"){var t=v,x=u,s=w}else{var x=v,s=u,t=w}n.disabledModule(s,"geolocation")}};m.internal={ping:function(t,u,s){n.priv.call("internal.ping",{data:[t]},u,s)},call:n.priv.call,addEventListener:n.addEventListener};m.is={};m.launchimage={hide:function(t,s){n.priv.call("launchimage.hide",{},t,s)}};if(window.addEventListener){window.addEventListener("load",function(){m.launchimage.hide()},false)}var j=function(y,w,z){var u=[];stylize=function(B,A){return B};function s(A){return A instanceof RegExp||(typeof A==="object"&&Object.prototype.toString.call(A)==="[object RegExp]")}function t(A){return A instanceof Array||Array.isArray(A)||(A&&A!==Object.prototype&&t(A.__proto__))}function v(C){if(C instanceof Date){return true}if(typeof C!=="object"){return false}var A=Date.prototype&&Object.getOwnPropertyNames(Date.prototype);var B=C.__proto__&&Object.getOwnPropertyNames(C.__proto__);return JSON.stringify(B)===JSON.stringify(A)}function x(M,J){try{if(M&&typeof M.inspect==="function"&&!(M.constructor&&M.constructor.prototype===M)){return M.inspect(J)}switch(typeof M){case"undefined":return stylize("undefined","undefined");case"string":var A="'"+JSON.stringify(M).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return stylize(A,"string");case"number":return stylize(""+M,"number");case"boolean":return stylize(""+M,"boolean")}if(M===null){return stylize("null","null")}if(M instanceof Document){return(new XMLSerializer()).serializeToString(M)}var G=Object.keys(M);var N=w?Object.getOwnPropertyNames(M):G;if(typeof M==="function"&&N.length===0){var B=M.name?": "+M.name:"";return stylize("[Function"+B+"]","special")}if(s(M)&&N.length===0){return stylize(""+M,"regexp")}if(v(M)&&N.length===0){return stylize(M.toUTCString(),"date")}var C,K,H;if(t(M)){K="Array";H=["[","]"]}else{K="Object";H=["{","}"]}if(typeof M==="function"){var F=M.name?": "+M.name:"";C=" [Function"+F+"]"}else{C=""}if(s(M)){C=" "+M}if(v(M)){C=" "+M.toUTCString()}if(N.length===0){return H[0]+C+H[1]}if(J<0){if(s(M)){return stylize(""+M,"regexp")}else{return stylize("[Object]","special")}}u.push(M);var E=N.map(function(P){var O,Q;if(M.__lookupGetter__){if(M.__lookupGetter__(P)){if(M.__lookupSetter__(P)){Q=stylize("[Getter/Setter]","special")}else{Q=stylize("[Getter]","special")}}else{if(M.__lookupSetter__(P)){Q=stylize("[Setter]","special")}}}if(G.indexOf(P)<0){O="["+P+"]"}if(!Q){if(u.indexOf(M[P])<0){if(J===null){Q=x(M[P])}else{Q=x(M[P],J-1)}if(Q.indexOf("\n")>-1){if(t(M)){Q=Q.split("\n").map(function(R){return"  "+R}).join("\n").substr(2)}else{Q="\n"+Q.split("\n").map(function(R){return"   "+R}).join("\n")}}}else{Q=stylize("[Circular]","special")}}if(typeof O==="undefined"){if(K==="Array"&&P.match(/^\d+$/)){return Q}O=JSON.stringify(""+P);if(O.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){O=O.substr(1,O.length-2);O=stylize(O,"name")}else{O=O.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");O=stylize(O,"string")}}return O+": "+Q});u.pop();var L=0;var D=E.reduce(function(O,P){L++;if(P.indexOf("\n")>=0){L++}return O+P.length+1},0);if(D>50){E=H[0]+(C===""?"":C+"\n ")+" "+E.join(",\n  ")+" "+H[1]}else{E=H[0]+C+" "+E.join(", ")+" "+H[1]}return E}catch(I){return"[No string representation]"}}return x(y,(typeof z==="undefined"?2:z))};var b=function(t,u){if("logging" in m.config){var s=m.config.logging.marker||"FORGE"}else{var s="FORGE"}t="["+s+"] "+(t.indexOf("\n")===-1?"":"\n")+t;n.priv.call("logging.log",{message:t,level:u});if(typeof console!=="undefined"){switch(u){case 10:if(console.debug!==undefined&&!(console.debug.toString&&console.debug.toString().match("alert"))){console.debug(t)}break;case 30:if(console.warn!==undefined&&!(console.warn.toString&&console.warn.toString().match("alert"))){console.warn(t)}break;case 40:case 50:if(console.error!==undefined&&!(console.error.toString&&console.error.toString().match("alert"))){console.error(t)}break;default:case 20:if(console.info!==undefined&&!(console.info.toString&&console.info.toString().match("alert"))){console.info(t)}break}}};var l=function(s,t){if(s in m.logging.LEVELS){return m.logging.LEVELS[s]}else{m.logging.__logMessage("Unknown configured logging level: "+s);return t}};var q=function(t){var w=function(x){if(x.message){return x.message}else{if(x.description){return x.description}else{return""+x}}};if(t){var v="\nError: "+w(t);try{if(t.lineNumber){v+=" on line number "+t.lineNumber}if(t.fileName){var s=t.fileName;v+=" in file "+s.substr(s.lastIndexOf("/")+1)}}catch(u){}if(t.stack){v+="\r\nStack trace:\r\n"+t.stack}return v}return""};m.logging={LEVELS:{ALL:0,DEBUG:10,INFO:20,WARNING:30,ERROR:40,CRITICAL:50},debug:function(t,s){m.logging.log(t,s,m.logging.LEVELS.DEBUG)},info:function(t,s){m.logging.log(t,s,m.logging.LEVELS.INFO)},warning:function(t,s){m.logging.log(t,s,m.logging.LEVELS.WARNING)},error:function(t,s){m.logging.log(t,s,m.logging.LEVELS.ERROR)},critical:function(t,s){m.logging.log(t,s,m.logging.LEVELS.CRITICAL)},log:function(t,s,w){if(typeof(w)==="undefined"){var w=m.logging.LEVELS.INFO}try{var u=l(m.config.logging.level,m.logging.LEVELS.ALL)}catch(v){var u=m.logging.LEVELS.ALL}if(w>=u){b(j(t,false,10)+q(s),w)}}};m.media={videoPlay:function(t,u,s){n.disabledModule(s,"media")}};m.message={listen:function(t,u,s){n.disabledModule(s,"message")},broadcast:function(t,u,v,s){n.disabledModule(s,"message")},broadcastBackground:function(t,u,v,s){n.disabledModule(s,"message")},toFocussed:function(t,u,v,s){n.disabledModule(s,"message")}};m.notification={create:function(v,u,t,s){n.disabledModule(s,"notification")},setBadgeNumber:function(t,u,s){n.disabledModule(s,"notification")}};m.payments={purchaseProduct:function(t,u,s){n.disabledModule(s,"payments")},restoreTransactions:function(t,s){n.disabledModule(s,"payments")},transactionReceived:{addListener:function(t,s){n.disabledModule(s,"payments")}}};m.prefs={get:function(t,u,s){n.disabledModule(s,"prefs")},set:function(t,u,v,s){n.disabledModule(s,"prefs")},keys:function(t,s){n.disabledModule(s,"prefs")},all:function(t,s){n.disabledModule(s,"prefs")},clear:function(t,u,s){n.disabledModule(s,"prefs")},clearAll:function(t,s){n.disabledModule(s,"prefs")}};m.reload={updateAvailable:function(t,s){n.disabledModule(s,"reload")},update:function(t,s){n.disabledModule(s,"reload")},applyNow:function(t,s){n.disabledModule(s,"reload")},switchStream:function(t,u,s){n.disabledModule(s,"reload")},updateReady:{addListener:function(t,s){n.disabledModule(s,"reload")}}};m.request={get:function(t,u,s){n.disabledModule(s,"request")},ajax:function(s){n.disabledModule(s.error,"request")}};m.sms={send:function(u,t,s){n.disabledModule(s,"sms")}};m.tabbar={show:function(t,s){n.disabledModule(s,"tabbar")},hide:function(t,s){n.disabledModule(s,"tabbar")},addButton:function(u,t,s){n.disabledModule(s,"tabbar")},removeButtons:function(t,s){n.disabledModule(s,"tabbar")},setTint:function(s,u,t){n.disabledModule(t,"tabbar")},setActiveTint:function(s,u,t){n.disabledModule(t,"tabbar")},setInactive:function(t,s){n.disabledModule(s,"tabbar")}};m.tabs={open:function(t,u,v,s){if(typeof u==="function"){s=v;v=u;u=false}n.disabledModule(s,"tabs")},openWithOptions:function(t,u,s){n.disabledModule(s,"tabs")},closeCurrent:function(s){n.disabledModule(s,"tabs")}};m.tools={UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){var t=Math.random()*16|0;var s=u=="x"?t:(t&3|8);return s.toString(16)}).toUpperCase()},getURL:function(t,u,s){n.priv.call("tools.getURL",{name:t.toString()},u,s)}};m.topbar={show:function(t,s){n.disabledModule(s,"topbar")},hide:function(t,s){n.disabledModule(s,"topbar")},setTitle:function(u,t,s){n.disabledModule(s,"topbar")},setTitleImage:function(t,u,s){n.disabledModule(s,"topbar")},setTint:function(s,u,t){n.disabledModule(t,"topbar")},addButton:function(t,u,s){n.disabledModule(s,"topbar")},removeButtons:function(t,s){n.disabledModule(s,"topbar")},homePressed:{addListener:function(t,s){n.disabledModule(s,"topbar")}}};m.ui={enhanceInput:function(s,u,t){n.disabledModule(t,"ui")},enhanceAllInputs:function(t,s){n.disabledModule(s,"ui")}};m.urlhandler={urlLoaded:{addListener:function(t,s){n.disabledModule(s,"urlhandler")}}};var o=[];var g=false;n.priv.get=function(){var s=JSON.stringify(o);o=[];return s};var f=[],k="zero-timeout-message";function d(s){f.push(s);window.postMessage(k,"*")}function c(s){setTimeout(s,0)}function e(s){if(s.source==window&&s.data==k){if(s.stopPropagation){s.stopPropagation()}if(f.length){f.shift()()}}}if(window.postMessage){if(window.addEventListener){window.addEventListener("message",e,true)}else{if(window.attachEvent){window.attachEvent("onmessage",e)}}window.setZeroTimeout=d}else{window.setZeroTimeout=c}n.priv.send=function(s){o.push(s);if(g&&!window.forge._flushing){window.forge._flushing=true;c(function(){window.location.href="forge://go"})}};document.addEventListener("DOMContentLoaded",function(){g=true;window.forge._flushing=true;c(function(){window.location.href="forge://go"})},false);m._get=n.priv.get;m._receive=function(){var s=arguments;if(typeof window.setZeroTimeout==="undefined"){setTimeout(function(){n.priv.receive.apply(this,s)},0)}else{c(function(){n.priv.receive.apply(this,s)})}};window.forge=m;window.forge["reload"]={updateAvailable:m.reload.updateAvailable,update:m.reload.update,applyNow:m.reload.applyNow,switchStream:m.reload.switchStream,updateReady:{addListener:m.reload.updateReady.addListener}};window.forge["ajax"]=m.request.ajax;window.forge["getPage"]=m.request.get;window.forge["createNotification"]=m.notification.create;window.forge["UUID"]=m.tools.UUID;window.forge["getURL"]=m.tools.getURL;window.forge["log"]=m.logging.log;window.forge["button"]["setUrl"]=m.button.setURL;window.forge["button"]["setBadgeText"]=m.button.setBadge;window.forge["file"]["delete"]=m.file.remove;window.forge["file"]["imageURL"]=m.file.URL})();